from termcolor import colored
import colorama
import requests as req
import time


#subsearcher exploit
def subsearcher():
    colorama.init()
    ur = str(input("Target url : ") or "https://www.github.com/")
    i = int(input("Intervalle between each request (default is 0ms) : ") or 0)
    w = str(input("wordlist (default is common.txt) : ") or "module/Xsploit/common.txt")
    exten = str(input("Extension at the end (e.g .php) : ") or "")
    print("")
    inte=i/1000
    with open(w) as f:
        lines = f.readlines()
        
    httpverify = ur[0:4]

    if httpverify != "http":
        ur= "http://"+ ur
    u = ur

    try:
        for i in range(len(lines)):
            ext = lines[i].replace("\n","").strip()
            nurl = u + ext + exten
            print(f"Testing {nurl}" + " " * 40, end="\r")
            resp = req.get(nurl)
            if resp.status_code != 404:
                print(colored(f'[+]-One new url found : {nurl} with response code [{str(resp.status_code)}] and SIZE : {len(resp.content)}',"cyan"))
            time.sleep(inte)
    except KeyboardInterrupt:
        print(colored("\nExploit cancelled\n","red"))
        pass



#basic sql injection
def sql_simple_injection(args):
    return